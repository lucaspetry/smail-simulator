<!doctype html>
<html lang="pt-br">
    
<head>
    <meta charset="utf-8">
    <meta name="description" content="Smail: Simulator">
    <meta name="author" content="Lucas May Petry">
    
    <title>Smail: Simulador</title>
    
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/menu.css">
    
    <script src="js/function.js"></script>
    <script src="js/operationCenter.js"></script>
    <script src="js/smailSimulator.js"></script>
</head>

<body>
    <div id="menu">
        <ul>
            <li onclick="showHideBox('about_box')">
                <img src="images/appbar.information.png" width="50px" />
                <span class="tooltiptext">Sobre</span>
            </li>
            <li onclick="showHideBox('settings_box')">
                <img src="images/appbar.cog.png" width="50px" />
                <span class="tooltiptext">Configurações</span>
            </li>
            <li onclick="showHideBox('time_settings_box')">
                <img src="images/appbar.timer.png" width="50px" />
                <span class="tooltiptext">Tempo de Simulação</span>
            </li>
            <li id="btn_play" onclick="playSimulation(this)">
                <img id="img_play" src="images/appbar.control.play.png" width="50px" />
                <span class="tooltiptext">Iniciar/Pausar</span>
            </li>
            <li>
                <img src="images/appbar.control.fastforward.variant.png" width="50px" />
                <span class="tooltiptext">Passo-a-Passo</span>
            </li>
            <li id="btn_stop" onclick="stopSimulation()">
                <img src="images/appbar.control.stop.png" width="50px" />
                <span class="tooltiptext">Parar</span>
            </li>
        </ul> 
    </div>
    <div id="main_box">
        <h3>Smail: Simulador de Servidores de E-mails</h3>
    </div>
    
    
    <div id="black_box"></div>
    <div id="about_box">Sobre</div>
    <div id="settings_box">
        <div class="scroll_box">
            <h3>Parâmetros de Simulação</h3>
            <br>
            <table border="0" style="width: 100%">
                
                <tr>
                    <td style="vertical-align: top;">
                        <table border="0">
                            <caption>Centros de Serviço</caption>
                            <tr>
                                <th style="text-align: left;">Centro de Serviço</th>
                                <th>Servidores</th>
                            </tr>
                            <tr>
                                <td class="label_field">Destino Local</td>
                                <td><input class="input_field" type="number" id="field_serversLocal"></td>
                            </tr>
                            <tr>
                                <td class="label_field">Destino Remoto</td>
                                <td><input class="input_field" type="number" id="field_serversRemote"></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <table border="0">
                            <caption>Volume de Tráfego (%)</caption>
                            <tr>
                                <th style="text-align: left;">Direção</th>
                                <th>Volume</th>
                            </tr>
                            <tr>
                                <td class="label_field">Local -> Local</td>
                                <td><input class="input_field" type="number" id="field_trafficLL"></td>
                            </tr>
                            <tr>
                                <td class="label_field">Local -> Remoto</td>
                                <td><input class="input_field" type="number" id="field_trafficLR"></td>
                            </tr>
                            <tr>
                                <td class="label_field">Remoto -> Local</td>
                                <td><input class="input_field" type="number" id="field_trafficRL"></td>
                            </tr>
                            <tr>
                                <td class="label_field">Remoto -> Remoto</td>
                                <td><input class="input_field" type="number" id="field_trafficRR"></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                
                <br>
                <table border="0">
                    <caption>Proporção de Sucessos, Falhas e Adiamentos (%)</caption>
                    <tr>
                        <th style="text-align: left;">Direção</th>
                        <th>Sucesso</th>
                        <th>Falha</th>
                        <th>Adiamento</th>
                    </tr>
                    <tr>
                        <td class="label_field">Local -> Local</td>
                        <td><input class="input_field" type="number" id="field_rateSuccessLL"></td>
                        <td><input class="input_field" type="number" id="field_rateFailureLL"></td>
                        <td><input class="input_field" type="number" id="field_ratePostponementLL"></td>
                    </tr>
                    <tr>
                        <td class="label_field">Local -> Remoto</td>
                        <td><input class="input_field" type="number" id="field_rateSuccessLR"></td>
                        <td><input class="input_field" type="number" id="field_rateFailureLR"></td>
                        <td><input class="input_field" type="number" id="field_ratePostponementLR"></td>
                    </tr>
                    <tr>
                        <td class="label_field">Remoto -> Local</td>
                        <td><input class="input_field" type="number" id="field_rateSuccessRL"></td>
                        <td><input class="input_field" type="number" id="field_rateFailureRL"></td>
                        <td><input class="input_field" type="number" id="field_ratePostponementRL"></td>
                    </tr>
                    <tr>
                        <td class="label_field">Remoto -> Remoto</td>
                        <td><input class="input_field" type="number" id="field_rateSuccessRR"></td>
                        <td><input class="input_field" type="number" id="field_rateFailureRR"></td>
                        <td><input class="input_field" type="number" id="field_ratePostponementRR"></td>
                    </tr>
                </table>
                <br>
                <table border="0">
                    <caption>Tempo Entre Chegada de E-mails</caption>
                    <tr>
                        <th style="text-align: left;">Origem</th>
                        <th>Distribuição</th>
                    </tr>
                    <tr>
                        <td class="label_field">Local</td>
                        <td>
                            <select id="field_arrivalIntervalLocal" style="width: 100px;">
                                <option value="EXPO">Exponencial</option>
                                <option value="NORM" disabled>Normal</option>
                                <option value="TRIA" disabled>Triangular</option>
                                <option value="UNIF" disabled>Uniforme</option>
                            </select>
                        </td>
                        <td><input class="input_field" type="number" id="field_arrivalIntervalLocalParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_arrivalIntervalLocalParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_arrivalIntervalLocalParam3" disabled></td>                    
                    </tr>
                    <tr>
                        <td class="label_field">Remota</td>
                        <td>
                            <select id="field_arrivalIntervalRemote" style="width: 100px;">
                                <option value="EXPO">Exponencial</option>
                                <option value="NORM" disabled>Normal</option>
                                <option value="TRIA" disabled>Triangular</option>
                                <option value="UNIF" disabled>Uniforme</option>
                            </select>
                        </td>
                        <td><input class="input_field" type="number" id="field_arrivalIntervalRemoteParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_arrivalIntervalRemoteParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_arrivalIntervalRemoteParam3" disabled></td>                    
                    </tr>
                </table><br>
                <table border="0">
                    <caption>Tempo de Serviço de Acordo com o Tipo de Processamento</caption>
                    <tr>
                        <th style="text-align: left;">Processamento</th>
                        <th>Recepção</th>
                        <th>Distribuição</th>
                    </tr>
                    <tr>
                        <td class="label_field">LLS</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_LLS" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_LLSParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_LLSParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_LLSParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">LLF</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_LLF" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_LLFParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_LLFParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_LLFParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">LLA</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_LLA" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_LLAParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_LLAParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_LLAParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">LRS</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_LRS" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_LRSParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_LRSParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_LRSParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">LRF</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_LRF" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_LRFParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_LRFParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_LRFParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">LRA</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_LRA" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_LRAParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_LRAParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_LRAParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">RLS</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_RLS" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_RLSParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_RLSParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_RLSParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">RLF</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_RLF" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_RLFParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_RLFParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_RLFParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">RLA</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_RLA" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_RLAParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_RLAParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_RLAParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">RRS</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_RRS" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_RRSParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_RRSParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_RRSParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">RRF</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_RRF" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_RRFParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_RRFParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_RRFParam3" disabled></td>
                    </tr>
                    <tr>
                        <td class="label_field">RRA</td>
                        <td><input class="input_field" type="number" id=""></td>
                        <td>
                            <select id="field_RRA" style="width: 100px;" onchange="updateFunctionParams(this)"></select>
                        </td>
                        <td><input class="input_field" type="number" id="field_RRAParam1" disabled></td>
                        <td><input class="input_field" type="number" id="field_RRAParam2" disabled></td>
                        <td><input class="input_field" type="number" id="field_RRAParam3" disabled></td>
                    </tr>
                </table>
            </table>
        </div>
    </div>
    
    <div id="time_settings_box">
        <table border="0">
            <tr>
                <td class="label_field">Tempo de Simulação</td>
                <td><input class="input_field" type="number" id="field_simulationTime"></td>
                <td>seg.</td>
            </tr>
            <tr>
                <td class="label_field">Semente de Aleatoriedade</td>
                <td><input class="input_field" type="number" id="field_simulationSeed"></td>
            </tr>
        </table>
    </div>

    <script>
        loadFunctionOptions(document.getElementById("field_LLS"));
        loadFunctionOptions(document.getElementById("field_LLF"));
        loadFunctionOptions(document.getElementById("field_LLA"));
        loadFunctionOptions(document.getElementById("field_LRS"));
        loadFunctionOptions(document.getElementById("field_LRF"));
        loadFunctionOptions(document.getElementById("field_LRA"));
        loadFunctionOptions(document.getElementById("field_RLS"));
        loadFunctionOptions(document.getElementById("field_RLF"));
        loadFunctionOptions(document.getElementById("field_RLA"));
        loadFunctionOptions(document.getElementById("field_RRS"));
        loadFunctionOptions(document.getElementById("field_RRF"));
        loadFunctionOptions(document.getElementById("field_RRA"));
        
        var simulation = new Simulation();
        loadDefaultSettings();
        
        function loadFunctionOptions(selectElement) {
            console.log("Method call: loadFunctionOptions(selectElement)");
            
            for(i = 0; i < Function.NUMBER_OF_FUNCTIONS; i++) {
                option = document.createElement("option");
                option.value = Function.NUMBER[Function.INDEX[i]];
                // option.disabled = true;
                option.innerHTML = Function.NAME[Function.INDEX[i]];
                selectElement.options.add(option, i);
            }
        }
        
        function updateFunctionParams(selectElement) {
            console.log("Method call: updateFunctionParams(selectElement)");
            
            selectedFunction = selectElement.options[selectElement.selectedIndex].value;
            functionParams = Function.PARAMS[Function.INDEX[selectedFunction] || Function.INDEX[0]];
            
            document.getElementById(selectElement.id + "Param1").disabled = true;
            document.getElementById(selectElement.id + "Param2").disabled = true;
            document.getElementById(selectElement.id + "Param3").disabled = true;
            
            switch(functionParams.length) {
                case 3:
                    document.getElementById(selectElement.id + "Param3").disabled = false;
                case 2:
                    document.getElementById(selectElement.id + "Param2").disabled = false;
                case 1:
                    document.getElementById(selectElement.id + "Param1").disabled = false;
                default:
                    break;
            }
        }
    
        function playSimulation(src) {
            console.log("Method call: playSimulation(src)");
            
            if(src.id == "btn_play") {
                src.id = "btn_pause";
                document.getElementById("img_play").setAttribute("src", "images/appbar.control.pause.png");
            } else {
                src.id = "btn_play";
                document.getElementById("img_play").setAttribute("src", "images/appbar.control.play.png");
            }
        }
        
        function stopSimulation() {
            console.log("Method call: stopSimulation()");
            
            document.getElementById("img_play").setAttribute("src", "images/appbar.control.play.png");
            document.getElementById("img_play").parentElement.id = "btn_play";
        }
        
        function showHideBox(divId) {
            console.log("Method call: showHideBox(divId)");
            
            // Se o container está visível, torna invisível, e vice-versa
            if(document.getElementById(divId).style.opacity == 0) {
                document.getElementById(divId).style.visibility = 'visible';
                document.getElementById(divId).style.opacity = 1;
            } else {
                document.getElementById(divId).style.opacity = 0;
                document.getElementById(divId).style.visibility = 'hidden';
            }
            
            // Se alguma das caixas de informação/configuração estiver ativa,
            // então esmaece a tela
            if(document.getElementById('about_box').style.visibility == 'visible'
              || document.getElementById('settings_box').style.visibility == 'visible'
              || document.getElementById('time_settings_box').style.visibility == 'visible') {
                document.getElementById('black_box').style.visibility = 'visible';
                document.getElementById('black_box').style.opacity = 0.7;                
            } else {
                document.getElementById('black_box').style.opacity = 0;
                document.getElementById('black_box').style.visibility = 'hidden';
            }
        }
        
        function loadDefaultSettings() {
            console.log("Method call: loadDefaultSettings()");
            
            document.getElementById('field_simulationTime').value = simulation.simulationTime; 
            document.getElementById('field_simulationSeed').value = simulation.simulationSeed;          
            
            document.getElementById('field_serversLocal').value = simulation.localServiceCenter.numberOfServers;
            document.getElementById('field_serversRemote').value = simulation.remoteServiceCenter.numberOfServers;
            
            document.getElementById('field_trafficLL').value = simulation.trafficLL;
            document.getElementById('field_trafficLR').value = simulation.trafficLR;
            document.getElementById('field_trafficRL').value = simulation.trafficRL;
            document.getElementById('field_trafficRR').value = simulation.trafficRR;
            
            document.getElementById('field_rateSuccessLL').value = simulation.trafficRateLL[0];
            document.getElementById('field_rateFailureLL').value = simulation.trafficRateLL[1];
            document.getElementById('field_ratePostponementLL').value = simulation.trafficRateLL[2];
            
            document.getElementById('field_rateSuccessLR').value = simulation.trafficRateLR[0];
            document.getElementById('field_rateFailureLR').value = simulation.trafficRateLR[1];
            document.getElementById('field_ratePostponementLR').value = simulation.trafficRateLR[2];
            
            document.getElementById('field_rateSuccessRL').value = simulation.trafficRateRL[0];
            document.getElementById('field_rateFailureRL').value = simulation.trafficRateRL[1];
            document.getElementById('field_ratePostponementRL').value = simulation.trafficRateRL[2];
            
            document.getElementById('field_rateSuccessRR').value = simulation.trafficRateRR[0];
            document.getElementById('field_rateFailureRR').value = simulation.trafficRateRR[1];
            document.getElementById('field_ratePostponementRR').value = simulation.trafficRateRR[2];
        }
    </script>
</body>
    
</html>